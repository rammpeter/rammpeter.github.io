<h3>Detection of unused tables</h3>
Tables never used for selections may be questioned for their right to exist.<br/>
This includes tables that were written, but never read.<br/>
<pre style='background-color: #FFFFCC;'>SELECT /* DB-Tools Ramm Nicht genutzte Tabellen */ o.*, sz.MBytes
                      FROM ( SELECT /*+ NO_MERGE */ 'TABLE' Object_Type, Owner, Table_Name Object_Name
                             FROM   DBA_Tables
                             WHERE  IOT_TYPE IS NULL AND Temporary='N'
                             UNION ALL
                             SELECT /*+ NO_MERGE */ 'INDEX' Object_Type, Owner, Index_Name Object_Name
                             FROM   DBA_Indexes
                             WHERE  Index_Type = 'IOT - TOP'
                           ) o
                      LEFT OUTER JOIN
                           (
                             SELECT /*+ NO_MERGE PARALLEL(p,2) FULL(p) PARALLEL(s,2) FULL(s) PARALLEL(t,2) FULL(t)*/
                                    DISTINCT p.Object_Type, p.Object_Owner, p.Object_Name
                             FROM   DBA_Hist_SQL_Plan p
                             JOIN   DBA_Hist_SQLStat s    ON  s.DBID            = p.DBID
                                                          AND s.SQL_ID          = p.SQL_ID
                                                          AND s.Plan_Hash_Value = p.Plan_Hash_Value
                             JOIN   DBA_Hist_SnapShot ss  ON  ss.DBID      = s.DBID
                                                          AND ss.Snap_ID = s.Snap_ID
                                                          AND ss.Instance_Number = s.Instance_Number
                             JOIN   DBA_Hist_SQLText t    ON  t.DBID   = p.DBID AND t.SQL_ID = p.SQL_ID
                             WHERE  ss.Begin_Interval_Time > SYSDATE-:P1
                             AND    t.SQL_Text NOT LIKE '%dbms_stats cursor_sharing_exact%' /* DBMS-Stats-Statement */
                             AND    (UPPER(t.SQL_Text) LIKE 'SELECT%' OR UPPER(t.SQL_Text) LIKE 'WITH%')
                             UNION
                             SELECT /*+ NO_MERGE */ DISTINCT p.Object_Type, p.Object_Owner, p.Object_Name
                             FROM   gv$SQL_Plan p
                             JOIN   gv$SQLArea s ON (s.Inst_ID=p.Inst_ID AND s.SQL_ID=p.SQL_ID AND s.Plan_Hash_Value=p.Plan_Hash_Value)
                             WHERE  s.Last_Active_Time > SYSDATE-:P2
                             AND    s.SQL_FullText NOT LIKE '%dbms_stats cursor_sharing_exact%' /* DBMS-Stats-Statement */
                             AND    (UPPER(s.SQL_Text) LIKE 'SELECT%' OR UPPER(s.SQL_Text) LIKE 'WITH%')
                           ) used ON used.Object_Owner = o.Owner AND used.Object_Name = o.Object_Name
                      LEFT OUTER JOIN (SELECT Segment_Name, Owner, SUM(bytes)/(1024*1024) MBytes
                                       FROM   DBA_SEGMENTS
                                       GROUP BY Segment_Name, Owner
                                      ) sz ON sz.SEGMENT_NAME = o.Object_Name AND sz.Owner = o.Owner
                      WHERE  used.Object_Owner IS NULL
                      AND    used.Object_Name IS NULL
                      AND    o.Owner NOT IN ('SYS', 'SYSTEM', 'WMSYS', 'OUTLN', 'MDSYS', 'OLAPSYS', 'EXFSYS', 'DBSNMP', 'SYSMAN', 'XDB', 'CTXSYS', 'DMSYS')
                      ORDER BY sz.MBytes DESC NULLS LAST</pre><div>Parameter :P1: Number of days backward for evaluation of AWR-history regarding match in SQL-text</div><div>Parameter :P2: Number of days backward for evaluation of AWR-history regarding existence in explain-plan</div>