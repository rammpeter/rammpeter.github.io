<h3>Detection of tables never accessed by SELECT statements</h3>
Tables never used for selections may be questioned for their right to exist.<br/>
This includes tables that were written, but never read.<br/>
<pre style='background-color: #FFFFCC;'>WITH Days AS (SELECT :P1 backward FROM DUAL)
                    SELECT /* DB-Tools Ramm Nicht genutzte Tabellen */ o.*, sz.MBytes, ob.Created, ob.Last_DDL_Time, tm.Timestamp Last_DML_Timestamp, tm.Inserts, tm.Updates, tm.Deletes
                    FROM ( SELECT /*+ NO_MERGE */ 'TABLE' Object_Type, Owner, Table_Name Object_Name, Last_Analyzed, Num_Rows
                           FROM   DBA_Tables
                           WHERE  IOT_TYPE IS NULL AND Temporary='N'
                           UNION ALL
                           SELECT /*+ NO_MERGE */ 'INDEX' Object_Type, Owner, Index_Name Object_Name, Last_Analyzed, Num_Rows
                           FROM   DBA_Indexes
                           WHERE  Index_Type = 'IOT - TOP'
                         ) o
                    LEFT OUTER JOIN
                         (
                           SELECT /*+ NO_MERGE PARALLEL(p,2) FULL(p) PARALLEL(s,2) FULL(s) PARALLEL(t,2) FULL(t)*/
                                  DISTINCT p.Object_Type, p.Object_Owner, p.Object_Name
                           FROM   DBA_Hist_SQL_Plan p
                           JOIN   DBA_Hist_SQLStat s    ON  s.DBID            = p.DBID
                                                        AND s.SQL_ID          = p.SQL_ID
                                                        AND s.Plan_Hash_Value = p.Plan_Hash_Value
                           JOIN   DBA_Hist_SnapShot ss  ON  ss.DBID      = s.DBID
                                                        AND ss.Snap_ID = s.Snap_ID
                                                        AND ss.Instance_Number = s.Instance_Number
                           JOIN   DBA_Hist_SQLText t    ON  t.DBID   = p.DBID AND t.SQL_ID = p.SQL_ID
                           WHERE  ss.Begin_Interval_Time > SYSDATE - (SELECT Backward FROM Days)
                           AND    t.SQL_Text NOT LIKE '%dbms_stats cursor_sharing_exact%' /* DBMS-Stats-Statement */
                           AND    t.Command_Type = 3 /* SELECT */
                           UNION
                           SELECT /*+ NO_MERGE */ DISTINCT p.Object_Type, p.Object_Owner, p.Object_Name
                           FROM   gv$SQL_Plan p
                           JOIN   gv$SQLArea s ON (s.Inst_ID=p.Inst_ID AND s.SQL_ID=p.SQL_ID AND s.Plan_Hash_Value=p.Plan_Hash_Value)
                           WHERE  s.Last_Active_Time > SYSDATE-(SELECT Backward FROM Days)
                           AND    s.SQL_FullText NOT LIKE '%dbms_stats cursor_sharing_exact%' /* DBMS-Stats-Statement */
                           AND    s.Command_Type = 3 /* SELECT */
                         ) used ON used.Object_Owner = o.Owner AND used.Object_Name = o.Object_Name
                    LEFT OUTER JOIN (SELECT Segment_Name, Owner, SUM(bytes)/(1024*1024) MBytes
                                     FROM   DBA_SEGMENTS
                                     GROUP BY Segment_Name, Owner
                                    ) sz ON sz.SEGMENT_NAME = o.Object_Name AND sz.Owner = o.Owner
                    LEFT OUTER JOIN DBA_Objects ob ON ob.Owner = o.Owner AND ob.Object_Name = o.Object_Name AND ob.SubObject_Name IS NULL
                    LEFT OUTER JOIN DBA_Tab_Modifications tm ON tm.Table_Owner = o.Owner AND tm.Table_Name = o.Object_Name AND tm.Partition_Name IS NULL AND tm.SubPartition_Name IS NULL
                    WHERE  used.Object_Owner IS NULL
                    AND    used.Object_Name IS NULL
                    AND    o.Owner NOT IN ('SYS', 'SYSTEM', 'WMSYS', 'OUTLN', 'MDSYS', 'OLAPSYS', 'EXFSYS', 'DBSNMP', 'SYSMAN', 'XDB', 'CTXSYS', 'DMSYS')
                    ORDER BY sz.MBytes DESC NULLS LAST</pre><div>Parameter :P1: Number of days backward for evaluation of AWR-history regarding usage of table in execution plans of SQL-statements</div>