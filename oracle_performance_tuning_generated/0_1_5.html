<h3>Coverage of foreign-key relations by indexes (detection of potentially unnecessary indexes)</h3>
Protection of existing foreign key constraint by index on referencing column may be unnecessary if:<br/>
- there are no physical deletes on referenced table<br/>
- full table scan on referencing table is acceptable during delete on referenced table<br/>
- possible shared lock issues on referencing table due to not existing index are no problem<br/>
Especially for references from large tables to small master data tables often there's no use for the effort of indexing referencing column.<br/>
Due to the poor selectivity such indexes are mostly not useful for access optimization.<pre style='background-color: #FFFFCC;'>SELECT /* DB-Tools Ramm Unnoetige Indizes auf Ref-Constraint*/
                           ri.Rows_Origin, ri.Owner, ri.Table_Name, ri.Index_Name, p.Constraint_Name, ri.Column_Name,
                           pi.Num_Rows Rows_Target, ri.Position, pi.Table_Name Target_Table, pi.Index_Name Target_Index
                    FROM   (SELECT /*+ NO_MERGE */
                                   r.Owner, r.Table_Name, r.Constraint_Name, rc.Column_Name, rc.Position, ric.Index_Name,
                                   r.R_Owner, r.R_Constraint_Name, ri.Num_Rows Rows_Origin
                            FROM   DBA_Constraints r,
                                   DBA_Cons_Columns rc,         -- Spalten des Foreign Key
                                   DBA_Ind_Columns ric,         -- passende Spalten eines Index
                                   DBA_Indexes ri
                            WHERE  r.Constraint_Type  = 'R'
                            AND    rc.Owner           = r.Owner
                            AND    rc.Constraint_Name = r.Constraint_Name
                            AND    ric.Table_Owner    = r.Owner
                            AND    ric.Table_Name     = r.Table_Name
                            AND    ric.Column_Name    = rc.Column_Name
                            AND    ric.Column_Position= rc.Position
                            AND    ri.Owner           = ric.Index_Owner
                            AND    ri.Index_Name      = ric.Index_Name
                           ) ri,                      -- Indizierte Foreign Key-Constraints
                           DBA_Constraints p,         -- referenzierter PKey-Constraint
                           DBA_Indexes     pi         -- referenzierter PKey-Index
                    WHERE  p.Owner            = ri.R_Owner
                    AND    p.Constraint_Name  = ri.R_Constraint_Name
                    AND    pi.Owner           = p.Owner
                    AND    pi.Index_Name      = p.Index_Name
                    AND    pi.Num_Rows < :P1                -- Begrenzung auf kleine referenzierte Tabellen
                    AND    ri.Rows_Origin > :P2        -- Mindestgroesse fuer referenzierende Tabelle
                    AND    (SELECT Count(*) FROM DBA_Constraints ri
                            WHERE  ri.r_owner = p.Owner AND ri.R_Constraint_Name=p.Constraint_Name
                           ) < :P3                      -- Begrenzung auf Anzahl referenzierende Tabellen
                    ORDER BY Rows_Origin DESC NULLS LAST</pre><div>Parameter :P1: Max. Anzahl Rows der referenzierten Tabelle</div><div>Parameter :P2: Mindestanzahl Rows der referenzierenden Tabelle</div><div>Parameter :P3: Max. Anzahl referenzierende Tabellen (bei groesserer Anzahl FullScan-Problem bei Delete auf Master)</div>