<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type" /></head>
<body onload="window.location = 'http://rammpeter.github.io/index.html?target=panorama_sampler';">

<div style="position: relative;" xmlns="http://www.w3.org/1999/html">
    <div class="shadow opaque" style="width:100%; height: 100%; background-color: #99CC99; position:absolute; top:0px; left:0px; z-index:1;">
    </div>
    <div style="position: relative; z-index: 2; padding: 10px;">
        <div id="panorama_sampler_global">
            <div id="panorama_sampler_text" style="float:left;">
                <h2>Panorama-Sampler for Oracle databases</h2>

                'Panorama-Sampler' is an add-on for Panorama which allows it's own database workload recording as alternative to use of AWR data.<br/>
                This enables you to use Panorama's functions for evaluation of historic workload info:
                <ul>
                    <li><b>with any database edition including Standard Edition</b></li>
                    <li><b>without licensing of Diagnostics Pack for Enterprise Edition</b></li>
                </ul>
                <img src="images/Panorama-Sampler.png"/><br/>
                <h3>Functions</h3>
                Panorama-Sampler delivers several functions for recording of historic workload information
                <ul>
                    <li>Replacement for Active Workload Repository (AWR) and Active Session History (ASH)</li>
                    <li>Sampling of storage object sizes</li>
                    <li>Sampling of DB-cache usage by objects</li>
                    <li>Sampling of detailed blocking lock information</li>
                </ul>
                Evaluation and visualization of recorded data is possible with Panorama's web client app.

                <h3>Usage</h3>

                <h4>Configure your Panorama server instance for Panorama-Sampler</h4>

                <ul>
                    <li>You enable Panorama-Sampler if you start Panorama with a master-password for Panorama-Sampler provided by environment variable PANORAMA_SAMPLER_MASTER_PASSWORD, for example:
                        <pre>PANORAMA_SAMPLER_MASTER_PASSWORD=mypasswd java -jar Panorama.war</pre> </li>
                    <li>If master-password is set, Panorama starts enhanced with:
                        <ul>
                            <li>Additional menu entry "Panorama-Sampler config" in menu "Spec. additions"</li>
                            <li>Background process for data sampling at each configured target database</li>
                        </ul>
                    </li>
                    <li>Access to GUI-function "Panorama-Sampler config" is protected by this master-password</li>
                    <li>You may use different master-passwords at Panorama-server startup if this makes sense for you. This results in one configuration-set per master-password.</li>
                </ul>

                <h4>Configure data sources for sampling with Panorama-Sampler</h4>

                <h5>To activate sampling for your database, add it at function "Panorama-Sampler config" in menu "Spec. additions" and configure:</h5>
                <ul>
                    <li>TNS-Alias resp. host, port, SID/service-name</li>
                    <li>user/password for the schema containing Panorama's tables for workload recording</li>
                    <li>Schema name if workload tables should be created in different schema than used for connection. Important e.g. for CDB where you need to login with system account to sample workload of all PDBs</li>
                    <li>For each of the four topics AWR/ASH, size evolution, cache-usage and blocking locks you can define separately:
                        <ul>
                            <li>Activate or deactivate sampling</li>
                            <li>Period between snapshots</li>
                            <li>Retention time before housekeeping</li>
                            <li>Further topic specific settings</li>
                        </ul>
                    </li>
                </ul>
                <img src="images/Panorama-Sampler-Config.png"/><br/>
                <h5>The configured connection user needs the the following grants to work:</h5>
                <ul>
                    <li><pre style="display: inline;">GRANT CONNECT, RESOURCE, CREATE VIEW</pre> to create tables and views</li>
                    <li>Enough quota on it's default tablespace to create objects</li>
                    <li><pre style="display: inline;">GRANT SELECT ANY DICTIONARY</pre> to select from dictionary tables</li>
                    <li><pre style="display: inline;">GRANT EXECUTE ON DBMS_LOCK</pre> as SYS to allow execution of DBMS_LOCK.SLEEP in active session sampler</li>
                    <li>The right to create objects in different object schema if connection user and object schema are different</li>
                </ul>
                If the connection user has the grant <pre style="display: inline;">GRANT SELECT ANY TABLE</pre> in addition, than PL/SQL-packages are created for the execution of sampling.</br>
                If the connection user doesn't have this grant, than larger anonymous PL/SQL is executed at each snapshot instead of package call that may result in a bit more parse effort.<br>
                Reason for need of possible anonymous PL/SQL is: you may not select from V$-tables from inside PL/SQL-packages because this right is based on role SELECT_CATALOG_ROLE and roles are not propagated to PL/SQL objects.

                <h4>Choose access on Panorama-Sampler's data in Panorama's web client application</h4>
                Panorama client automatically recognizes existence of Panorama-Sampler data during logon and offers you to choose this data.
                You can choose one of three options how Panorama gets access to historic workload info for this database:
                <ul>
                    <li>Use Oracle's AWR data which requires Enterprise Edition and licensing of Diagnostics Pack for that database</li>
                    <li>Use workload data recorded by Panorama's own sampling engine</li>
                    <li>Don't use historic workload info, but this way Panorama's functions are strongly reduced</li>
                </ul>

                <img src="images/choose_management_pack.png"/><br/>
                <span style="color: coral">Please consider that Panorama-Sampler's tables are created deferred at first snapshot execution.<br/>
                This way you can choose Panorama-Sampler only after first snapshot execution.</span>

                <h3>Licensing</h3>

                You may use Panorama-Sampler for free under the terms and conditions of <a href="http://www.gnu.org/licenses/gpl-3.0" target="_blank">GNU General Public License</a>.

                <h3>Function volume</h3>
                Until now Panorama-Sampler offers replacement for the follwing AWR views:
                <ul>
                    <li>gv$Active_Session_History</li>
                    <li>DBA_Hist_Active_Sess_History</li>
                    <li>DBA_Hist_Cache_Advice</li>
                    <li>DBA_Hist_IOStat_Filetype</li>
                    <li>DBA_Hist_Log</li>
                    <li>DBA_Hist_Resource_Limit</li>
                    <li>DBA_Hist_Seg_Stat</li>
                    <li>DBA_Hist_Service_Name</li>
                    <li>DBA_Hist_Snapshot</li>
                    <li>DBA_Hist_SQL_Bind</li>
                    <li>DBA_Hist_SQL_Plan</li>
                    <li>DBA_Hist_SQLStat</li>
                    <li>DBA_Hist_SQLText</li>
                    <li>DBA_Hist_StatName</li>
                    <li>DBA_Hist_Sysmetric_History</li>
                    <li>DBA_Hist_Sysmetric_Summary</li>
                    <li>DBA_Hist_System_Event</li>
                    <li>DBA_Hist_SysStat</li>
                    <li>DBA_Hist_TopLevelCall_Name</li>
                    <li>DBA_Hist_WR_Control</li>
                </ul>
                <h3>Further implementation details</h3>
                <ul>
                    <li>For RAC-systems configure one sampler-entry for each RAC-instance with instance-specific service name or given SID.</li>
                    <li>You may use different master-passwords. This results in one configuration-set per master-password. Sampling is active only for the configuration set of the master password Panorama is started with</li>
                    <li>Sampling cycle for function similar to Active Session History is fixed to 1 seconds for short term storage (currently until next snapshot) and 10 seconds for long term storage</li>
                    <li>Your configured connection passwords are stored in file system at Panorama server encrypted with a combination of server key (see Panorama: What about security) and your master password</li>
                </ul>

                <h3>Limitations compared to AWR</h3>
                <h4>Sampling of active sessions</h4>
                <ul>
                    <li>Plan-line-ID and operation are not recorded because of missing source in v$-views</li>
                    <li>Only top level SQL is recorded as listed by v$Session.sql_id</li>
                    <li>I/O-Requests and amount read/written is not recorded because sampling from v$SesStat is too slow for one sample per second</li>
                </ul>
                <h4>Sampling of segment statistics</h4>
                <ul>
                    <li>'gc cr blocks served', 'gc current blocks served' and 'chain row excess' are not available from v$SegStat</li>
                </ul>

            </div>
        </div>
        <div style="clear: both;"></div>
    </div>
</div>

</body>
</html>
